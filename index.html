<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema CCH - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="estilo.css">
    <style>
        .input-edit {
            width: 75px;
            text-align: center;
            border: 1px solid #007bff;
            border-radius: 4px;
            padding: 2px;
        }

        .is-editing {
            background-color: #fff9db !important;
        }
    </style>
</head>

<body>

    <div class="dashboard-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo"><i class="fas fa-school"></i> <span>Sistema CCH</span></div>
                <button class="btn-close-sidebar d-md-none" onclick="App.toggleSidebar()"><i
                        class="fas fa-times"></i></button>
            </div>
            <nav class="sidebar-nav">
                <a href="#inicio" class="active" data-section="inicio" onclick="App.handleNavClick(this, 'inicio')"><i
                        class="fas fa-home"></i> <span>Inicio</span></a>
                <a href="#maga1" data-section="maga1" onclick="App.handleNavClick(this, 'maga1')"><i
                        class="fas fa-arrow-up-1-9"></i> <span>MAGA 1</span></a>
                <a href="#maga2" data-section="maga2" onclick="App.handleNavClick(this, 'maga2')"><i
                        class="fas fa-square-root-variable"></i> <span>MAGA 2</span></a>
                <a href="#maga3" data-section="maga3" onclick="App.handleNavClick(this, 'maga3')"><i
                        class="fas fa-calculator"></i> <span>MAGA 3</span></a>
                <a href="#cyc" data-section="cyc" onclick="App.handleNavClick(this, 'cyc')"><i
                        class="fas fa-laptop-code"></i> <span>CYC 1</span></a>
                <a href="#estadistica" data-section="estadistica" onclick="App.handleNavClick(this, 'estadistica')"><i
                        class="fas fa-chart-pie"></i> <span>Estad铆stica</span></a>
            </nav>
        </aside>

        <main class="main-content">
            <header class="mobile-header d-md-none mb-3">
                <button class="btn btn-dark" onclick="App.toggleSidebar()"><i class="fas fa-bars"></i></button>
                <span class="fw-bold ms-2">Sistema CCH</span>
            </header>

            <section id="inicio" class="content-section active">
                <h2 class="h4 mb-4"><i class="fas fa-chalkboard-teacher text-primary"></i> Panel de Control</h2>
                <div class="row g-3">
                    <div class="col-12 col-sm-6 col-md-3" onclick="App.loadSection('maga1')">
                        <div class="card p-4 shadow-sm text-center border-0 bg-white hover-card"><h5
                                class="fw-bold mt-2">MAGA 1</h5>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3" onclick="App.loadSection('maga2')">
                        <div class="card p-4 shadow-sm text-center border-0 bg-white hover-card"><h5
                                class="fw-bold mt-2">MAGA 2</h5>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3" onclick="App.loadSection('cyc')">
                        <div class="card p-4 shadow-sm text-center border-0 bg-white hover-card"><h5
                                class="fw-bold mt-2">CYC 1</h5>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3" onclick="App.loadSection('estadistica')">
                        <div class="card p-4 shadow-sm text-center border-0 bg-white hover-card"><h5
                                class="fw-bold mt-2">Estad铆stica</h5>
                        </div>
                    </div>
                </div>
            </section>

            <section id="reporte-view" class="content-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 id="view-title" class="h4 mb-0">Reporte</h2>
                    <div>
                        <button class="btn btn-outline-primary btn-sm" id="btn-unlock" onclick="App.openAuthModal()"><i
                                class="fas fa-lock"></i> - </button>
                        <button class="btn btn-outline-danger btn-sm d-none" id="btn-lock"
                            onclick="App.lockEdition()"><i class="fas fa-lock-open"></i> Bloquear Edici贸n</button>
                    </div>
                </div>

                <div class="stats-grid mb-4">
                    <div class="stat-card border-primary">
                        <div class="stat-label text-muted small fw-bold">ALUMNOS</div>
                        <div class="stat-value h2" id="stat-total">0</div>
                    </div>
                    <div class="stat-card border-success">
                        <div class="stat-label text-muted small fw-bold">ASISTENCIA</div>
                        <div class="stat-value h2" id="stat-avg">0%</div>
                    </div>
                    <div class="stat-card border-danger">
                        <div class="stat-label text-muted small fw-bold">RIESGO</div>
                        <div class="stat-value h2" id="stat-risk">0</div>
                    </div>
                </div>

                <div class="row g-2 mb-4">
                    <div class="col-md-6">
                        <div class="alert alert-warning py-2 border-0 shadow-sm mb-0">
                            <h5><span class="badge text-dark">硷</span> Trabajo adicional</h5>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="alert alert-danger py-2 border-0 shadow-sm mb-0">
                            <h5><span class="badge bg-danger">锔 NP</span> No present贸</h5>
                        </div>
                    </div>
                </div>

                <input type="text" id="tableSearch" class="form-control mb-4" placeholder="Buscar por cuenta..."
                    onkeyup="App.filterTable()">

                <div class="card border-0 shadow-sm">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0 text-center" id="mainAttendanceTable"></table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div class="modal fade" id="authModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5>Seguridad</h5><button class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body"><input type="password" id="adminPass" class="form-control"
                        placeholder="Contrase帽a"></div>
                <div class="modal-footer"><button class="btn btn-primary w-100"
                        onclick="App.verifyPassword()">Desbloquear</button></div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.11/jsrender.min.js"></script>

    <script id="magaRowTmpl" type="text/x-jsrender">
        <thead class="table-light">
            <tr>
                {{if ~isEditable}}<th>Nombre</th>{{/if}}
                <th>Cuenta</th>
                <th>Faltas</th>
                <th>Sellos 60%</th>
                <th>Ex谩menes 40%</th>
                <th>Total 100%</th>
                {{if ~isEditable}}<th>Acci贸n</th>{{/if}}
            </tr>
        </thead>
        <tbody>
            {{for students}}
            <tr class="{{if ~isEditable}}is-editing{{/if}}">
                {{if ~isEditable}}<td class="text-start small">{{:nombre}}</td>{{/if}}
                <td>{{:cuenta}}</td>
                <td class="{{:~getStatusClass(faltas)}} fw-bold">{{:faltas}} {{:~getStatusBadge(faltas)}}</td>
                <td>{{:sellos}} %</td>
                <td>{{:examenes}} %</td>
                <td>
                    {{if ~isEditable}}
                        <input type="number" step="0.1" class="input-edit" id="input-{{:cuenta}}" value="{{:total}}">
                    {{else}}
                        <span class="fw-bold">{{:total}} %</span>
                    {{/if}}
                </td>
                {{if ~isEditable}}
                <td>
                    <button class="btn btn-success btn-sm" onclick="App.saveRow('{{:cuenta}}')">
                        <i class="fas fa-save"></i>
                    </button>
                </td>
                {{/if}}
            </tr>
            {{/for}}
        </tbody>
    </script>

    <script id="cycRowTmpl" type="text/x-jsrender">
        <thead class="table-light">
            <tr>
                {{if ~isEditable}}<th>Nombre</th>{{/if}}
                <th>Cuenta</th>
                <th>Faltas</th>
                <th>Tareas</th>
                <th>Ejercicios</th>
                <th>Part.</th>
                <th>Examen</th>
                <th>Total</th>
                {{if ~isEditable}}<th>Acci贸n</th>{{/if}}
            </tr>
        </thead>
        <tbody>
            {{for students}}
            <tr class="{{if ~isEditable}}is-editing{{/if}}">
                {{if ~isEditable}}<td class="text-start small">{{:nombre}}</td>{{/if}}
                <td>{{:cuenta}}</td>
                <td class="{{:~getStatusClass(faltas)}} fw-bold">{{:faltas}} {{:~getStatusBadge(faltas)}}</td>
                <td>{{:tareas}} %</td>
                <td>{{:ejercicios}} %</td>
                <td>{{:participaciones}} %</td>
                <td>{{:examenes}} %</td>
                <td>
                    {{if ~isEditable}}
                        <input type="number" step="0.1" class="input-edit" id="input-{{:cuenta}}" value="{{:total}}">
                    {{else}}
                        <span class="fw-bold">{{:total}} %</span>
                    {{/if}}
                </td>
                {{if ~isEditable}}
                <td>
                    <button class="btn btn-success btn-sm" onclick="App.saveRow('{{:cuenta}}')">
                        <i class="fas fa-save"></i>
                    </button>
                </td>
                {{/if}}
            </tr>
            {{/for}}
        </tbody>
    </script>

    <script id="estadRowTmpl" type="text/x-jsrender">
        <thead class="table-light">
            <tr>
                {{if ~isEditable}}<th>Nombre</th>{{/if}}
                <th>Cuenta</th>
                <th>Faltas</th>
                <th>Activ.</th>
                <th>Pr谩ct.</th>
                <th>Examen</th>
                <th>Total</th>
                {{if ~isEditable}}<th>Acci贸n</th>{{/if}}
            </tr>
        </thead>
        <tbody>
            {{for students}}
            <tr class="{{if ~isEditable}}is-editing{{/if}}">
                {{if ~isEditable}}<td class="text-start small">{{:nombre}}</td>{{/if}}
                <td>{{:cuenta}}</td>
                <td class="{{:~getStatusClass(faltas)}} fw-bold">{{:faltas}} {{:~getStatusBadge(faltas)}}</td>
                <td>{{:actividades}}</td><td>{{:practicas}}</td>
                <td>{{:examenes}}</td>
                <td>
                    {{if ~isEditable}}
                        <input type="number" step="0.1" class="input-edit" id="input-{{:cuenta}}" value="{{:total}}">
                    {{else}}
                        <span class="fw-bold">{{:total}}</span>
                    {{/if}}
                </td>
                {{if ~isEditable}}
                <td>
                    <button class="btn btn-success btn-sm" onclick="App.saveRow('{{:cuenta}}')">
                        <i class="fas fa-save"></i>
                    </button>
                </td>
                {{/if}}
            </tr>
            {{/for}}
        </tbody>
    </script>

    <script src="script.js"></script>
</body>

</html>